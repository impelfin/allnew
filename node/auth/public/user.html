<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>User Home</title>
    <link type="text/css" rel="stylesheet" href="mystyle.css" />
    <script>
      function getParameter(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
          results = regex.exec(location.search);
        return results === null
          ? ""
          : decodeURIComponent(results[1].replace(/\+/g, " "));
      }
      function sessionStore() {
        let id = getParameter("id");
        let now = new Date();
        if (!window.sessionStorage) {
          alert("세션 스토리지를 지원하지 않습니다.");
          return;
        }
        sessionStorage.setItem(id, now);
        alert(`사용자 ${id} 세션 스토리지 생성`);
      }
      window.addEventListener("beforeunload", (event) => {
        event.preventDefault();
        event.returnValue = "";
      });

      function logout() {
        let id = getParameter(id);
        sessionStorage.removeItem(id);
      }
    </script>
  </head>
  <body onload="sessionStore()" onunload="logout()">
    <nav id="menubar">
      <ul>
        <li><a href="user.html">Home</a></li>
        <li><a href="about.html" target="lower">AboutMe</a></li>
        <li style="position: fixed; right: 10px">
          <a href="index.html">logout</a>
        </li>
      </ul>
    </nav>
    <iframe
      name="lower"
      width="70%"
      height="500"
      style="border: none"
      src="main.html"
    ></iframe>
  </body>
</html>
